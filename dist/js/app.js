$(document).ready((()=>{let t=1,a=9;const e=$(".products-beers");let s,n,l,i=`https://api.punkapi.com/v2/beers?page=${t}&per_page=${a}`,o=`https://api.punkapi.com/v2/beers?page=${t}&per_page=${a}`;const c=$(".loading-modal"),r=async()=>{c.addClass("loading-modal-active");const t=await fetch(o),a=await t.json();s=a,n=s,m();let l="";$.each(n,((t,a)=>{let{image_url:e,name:s,id:n,description:i,abv:o}=a;e||(e="../dist/images/beer-bottle.png"),l+=`\n        <article class="products-card card">\n          <div class="card-img-wrapper">\n            <img src=${e} alt=${s} class="card-img" />\n            <button class="card-img-wrapper-btn" data-id=${n}><i class="fas fa-link"></i></button>\n          </div>\n          <div class="card-details">\n            <h3 class="card-heading">${s}</h3>\n            <p class="card-description">${i}</p>\n            <p class="card-abv">${o}</p>\n            <button class="card-btn" data-title=${s} data-id=${n} data-img=${e} data-abv=${o}>add to cart</button>\n          </div>\n        </article>\n      `}));0===s.length&&(l='\n      <div class="no-beers-container">\n        <p class="no-beers-notification">No beers that match your filters.</p>\n        <button class="no-beers-btn">reset filters</button>\n      </div>\n    '),e.html(l),A(),T(),c.removeClass("loading-modal-active")};r();const d=$(".products-modal");e.on("click",".card-img-wrapper-btn",(t=>{d.addClass("products-modal-active");const a=$(t.target).attr("data-id");let e={};$.each(s,((t,s)=>{s.id==a&&(e=s)}));const{image_url:n,name:l,description:i,food_pairing:o,ingredients:c}=e;let r="";$.each(o,((t,a)=>{r+=`<li class="modal-list-item"><i class="fas fa-chevron-right"></i> ${a}</li>`}));const{malt:b,hops:m,yeast:v}=c;let p=[],g=[];$.each(b,((t,a)=>{p.push(a.name)})),$.each(m,((t,a)=>{g.push(a.name)}));let h=p.join(", "),u=g.join(", "),k=`\n    <div class="modal-overlay"></div>\n    <div class="modal-content">\n      <button class="modal-close-btn">×</button>\n      <div class="modal-img-wrapper"><img src=${n} alt=${l} class="modal-img" /></div>\n      <div class="modal-info">\n        <h3 class="modal-heading">${l}</h3>\n        <p class="modal-description">${i}</p>\n        <div class="modal-lists">\n          <ul class="modal-list">\n          <h3 class="modal-list-heading">Best paired with:</h3>\n          ${r}\n          </ul>\n          <ul class="modal-list modal-list-ingredients">\n            <h3 class="modal-list-heading">Ingredients:</h3>\n            ${`\n     <li class="modal-list-item"><div><i class="fas fa-chevron-right"></i> <b>Malt:</b></div> ${h}</li>\n     <li class="modal-list-item"><div><i class="fas fa-chevron-right"></i> <b>Hops:</b></div> ${u}</li>\n     <li class="modal-list-item"><div><i class="fas fa-chevron-right"></i> <b>Yeast:</b></div> ${v}</li>\n      `}\n          </ul>\n        </div>\n        <button class="card-btn modal-btn" data-title=${e.name} data-id=${e.id} data-img=${e.image_url} data-abv=${e.abv}>add to cart</button>\n      </div>\n    </div>\n    `;d.html(k)}));const b=()=>{d.removeClass("products-modal-active")};d.on("click",".modal-close-btn",b);const m=()=>{switch(l){case"default":n=s;break;case"popularity":n=s.sort(((t,a)=>t.target_fg>a.target_fg?1:-1));break;case"rating":n=s.sort(((t,a)=>t.target_og>a.target_og?1:-1));break;case"date":n=s.sort(((t,a)=>t.first_brewed>a.first_brewed?1:-1));break;case"abv-low":n=s.sort(((t,a)=>t.abv>a.abv?1:-1));break;case"abv-high":n=s.sort(((t,a)=>t.abv<a.abv?1:-1));break;default:n=s}},v=$("#sorting-select");v.change((()=>{l=v.val(),r()}));const p=$(".nav"),g=$(".back-to-top-btn");$(window).on("scroll",(()=>{g.toggleClass("back-to-top-btn-fixed",this.scrollY>=200),$(window).width()<1024||p.toggleClass("header-nav-fixed",this.scrollY>=200)}));const h=$(".nav-links"),u=$(".nav-links-content"),k=$(".nav-btn"),w=$(".nav-links-overlay");k.on("click",(()=>{h.toggleClass("nav-links-active"),u.toggleClass("nav-links-content-active")})),w.on("click",(()=>{h.removeClass("nav-links-active"),u.removeClass("nav-links-content-active")}));const f=$(".nav-item");$.each(f,((t,a)=>{$(window).width()>1024&&($(a).on("mouseenter",(()=>{const t=$(".dropdown");$.each(t,((t,a)=>{$(a).removeClass("nav-link-dropdown-active")}));const e=$(a).children().last();e.hasClass("dropdown")&&e.addClass("nav-link-dropdown-active")})),$(a).on("mouseleave",(()=>{const t=$(a).children().last();t.hasClass("dropdown")&&t.removeClass("nav-link-dropdown-active")}))),$(window).width()<=1024&&$(a).on("click",(t=>{if($(t.target).hasClass("dropdown-link"))return;$(a).children().first().children().last().css("transform","rotateZ(-90deg)"),$.each(f,((t,e)=>{const s=$(e).children().last(),n=$(e).children().first().children().last();e!==a&&s.hasClass("nav-link-dropdown-active")&&(s.removeClass("nav-link-dropdown-active"),n.css("transform","rotateZ(90deg)")),s.hasClass("nav-link-dropdown-active")&&n.css("transform","rotateZ(90deg)")}));const e=$(a).children().last();let s;e.hasClass("nav-link-dropdown")&&(s=e),s&&s.toggleClass("nav-link-dropdown-active")}))}));const C=$(".dropdown-link-double");$.each(C,((t,a)=>{$(window).width()>1024&&($(a).on("mouseenter",(()=>{const t=$(".sublinks");$.each(t,((t,a)=>{$(a).removeClass("sublinks-active")}));const e=$(a).children().last();e.hasClass("sublinks")&&e.addClass("sublinks-active")})),$(a).on("mouseleave",(()=>{const t=$(a).children().last();t.hasClass("sublinks")&&t.removeClass("sublinks-active")}))),$(window).width()<=1024&&$(a).on("click",(()=>{$.each(C,((t,e)=>{const s=$(e).children().last();e!==a&&s.removeClass("sublinks-active")})),$(a).children().last().toggleClass("sublinks-active")}))})),g.on("click",(()=>{window.scrollTo(0,0)}));let y="tiles";$(".display-btn").click((t=>{y=$(t.target).hasClass("display-btn-list")?"list":"tiles",e.toggleClass("products-beers-list","list"===y)}));let _=1,I=$(".pages-numbers");const A=async()=>{const a=await fetch("https://api.punkapi.com/v2/beers");let e=(await a.json()).length;_=Math.ceil(e/9);let s="",n=1,l=4;2==t?(n=1,l=4):t>2&&(n=t-2,l=t+1);const i=o.replace(`page=${t}`,`page=${t+1}`),c=await fetch(i),r=await c.json(),d=o.replace(`page=${t}`,`page=${t+3}`),b=await fetch(d),m=await b.json(),$=o.replace(`page=${t}`,`page=${t+3}`),v=await fetch($);0===(await v.json()).length&&(n=t-1,l=t+1),0===m.length&&(n=t-1,l=t+1,1==t&&(l=t+2)),0===r.length&&(n=t-3,l=t),n<1&&(n=1);for(let a=n;a<=l;a++)s+=a===t?`\n        <li class="pages-numbers-item">\n        <button class="pages-numbers-btn pages-numbers-btn-active">${a}</button>\n        </li>\n        `:`\n        <li class="pages-numbers-item">\n        <button class="pages-numbers-btn">${a}</button>\n        </li>\n        `;N(),I.html(s)};A();I.on("click",".pages-numbers-btn",(a=>{let e=$(a.target);t&&(t=+e.text().trim()),et(),N()}));const x=$(".pages-btn-next");x.on("click",(()=>{t+=1,et(),N()}));const S=$(".pages-btn-prev");S.on("click",(()=>{t-=1,et(),N()}));const j=$(".pages-btn-first");j.on("click",(()=>{t=1,et(),N()}));const D=$(".pages-btn-last"),N=async()=>{1===t?(j.css({display:"none"}),S.css({display:"none"})):(j.css({display:"inline"}),S.css({display:"inline"}));const a=o.replace(`page=${t}`,`page=${t+1}`),e=await fetch(a);0!=(await e.json()).length?(D.css({display:"inline"}),x.css({display:"inline"})):(D.css({display:"none"}),x.css({display:"none"}))};N();const O=$(".display-amount-shown"),T=async()=>{const s=await fetch(o),n=await s.json();let l=t*e.children().length,i=l-a+1;i<1&&(i=1),0===n.length&&(i=0,l=0);let c=`${i}-${l}`;O.html(c)};T();let J=[];$(document).on("click",".card-btn",(t=>{const a=$(t.target),e=a.attr("data-id");let s,n=!1;if(a.addClass("card-btn-active"),setTimeout((()=>{a.removeClass("card-btn-active")}),2e3),0!==J.length)if($.each(J,((t,a)=>{a.beerID===e&&(n=!0)})),n){s=J.filter((t=>t.beerID===e))[0];const t=J.indexOf(s);J[t].beerAmount=s.beerAmount+1}else{let t={beerID:a.attr("data-id"),beerTitle:a.attr("data-title"),beerImg:a.attr("data-img"),beerAbv:a.attr("data-abv"),beerAmount:1};J=[...J,t]}else{let t={beerID:a.attr("data-id"),beerTitle:a.attr("data-title"),beerImg:a.attr("data-img"),beerAbv:a.attr("data-abv"),beerAmount:1};J.push(t)}sessionStorage.setItem("beerCart",JSON.stringify(J)),H()}));const Y=$(".cart-full"),F=$(".cart-empty"),Z=()=>{0===J.length?(Y.css({display:"none"}),F.css({display:"block"})):(Y.css({display:"flex"}),F.css({display:"none"}))};Z(),$(document).on("click",".item-remove-btn",(t=>{let a=$(t.target).attr("data-id");J=J.filter((t=>t.beerID!==a)),sessionStorage.setItem("beerCart",JSON.stringify(J)),H(),E()}));const M=$(".cart-total-value"),B=$(".cart-list"),H=()=>{J=JSON.parse(sessionStorage.getItem("beerCart")),J||(J=[]);let t="";$.each(J,((a,e)=>{const{beerID:s,beerTitle:n,beerImg:l,beerAbv:i,beerAmount:o}=e;t+=`\n      <li class="cart-item item" data-id=${s}>\n      <div class="item-img-wrapper">\n        <img src=${l} alt=${n} class="item-img" />\n      </div>\n      <div class="item-details">\n        <h4 class="item-heading">${n}</h4>\n        <p class="item-paragraph">\n          <span class="item-amount">${o}</span>\n          <span class="item-times">×</span>\n          <span class="item-price">$${i}</span>\n        </p>\n      </div>\n      <button class="item-remove-btn" data-id=${s}>×</button>\n    </li>\n      `})),B.html(t),Z(),(()=>{let t=0,a="";$.each(J,((a,e)=>{t+=e.beerAmount*e.beerAbv})),t=t.toFixed(2),a=`$${t}`,M.html(a)})()};H();const q=()=>{alert(`Your bill is ${M.text()}`),J=[],sessionStorage.setItem("beerCart",JSON.stringify(J)),H(),E()};$(".cart-btn-checkout").on("click",q);const z=$(".cart-modal"),E=()=>{let t="",a="",e=0;0===J.length&&(a='<p class="modal-cart-empty">No products in the cart</p>'),$.each(J,((t,s)=>{const{beerID:n,beerTitle:l,beerImg:i,beerAmount:o,beerAbv:c}=s;e+=o*c,a+=`\n      <li class="modal-item item" data-id=${n}>\n      <button class="item-remove-btn" data-id=${n} >×</button>\n        <div class="item-img-wrapper">\n          <img src=${i} alt=${l} class="item-img" />\n        </div>\n        <h5 class="item-heading">${l}</h5>\n        <div class="item-details">\n          <div class="item-amount-container">\n            <button class="item-amount-btn item-amount-increase-btn" data-id=${n}>\n              <i class="fas fa-sort-up"></i>\n            </button>\n            <span class="item-amount">${o}</span>\n            <button class="item-amount-btn item-amount-decrease-btn" data-id=${n}>\n              <i class="fas fa-sort-down"></i>\n            </button>\n          </div>\n          <span class="item-amount-times">×</span>\n          <p class="item-price">$${c}</p>\n        </div>\n        <p class="item-total">$${(o*c).toFixed(2)}</p>\n      </li>\n      `}));let s="";s=e>0?'<button class="cart-btn cart-btn-checkout modal-btn">checkout</button>':'<button class="cart-btn cart-btn-checkout modal-btn modal-btn-disabled">checkout</button>',t=`\n    <div class="modal-overlay"></div>\n    <div class="modal-content">\n      <button class="modal-close-btn">×</button>\n      <h3 class="modal-heading">Cart</h3>\n      <ul class="modal-list">\n        ${a}\n      </ul>\n      <div class="modal-footer">\n        <p class="modal-total">Subtotal: <span >$${e.toFixed(2)}</span></p>\n        ${s}\n      </div>\n    </div>\n    `,z.html(t)};$(".cart-btn-view").on("click",(()=>{z.addClass("cart-modal-active"),E()}));const G=()=>{z.removeClass("cart-modal-active")};z.on("click",".modal-close-btn",G),z.on("click",".item-amount-btn",(t=>{const a=$(t.target),e=a.attr("data-id");let s=J.filter((t=>t.beerID===e))[0];const n=J.indexOf(s);if(a.hasClass("item-amount-increase-btn"))J[n].beerAmount=s.beerAmount+1;else{if(1===s.beerAmount)return;J[n].beerAmount=s.beerAmount-1}sessionStorage.setItem("beerCart",JSON.stringify(J)),E(),H()})),z.on("click",".cart-btn-checkout",q);$("#per-page-select").on("change",(e=>{const s=$(e.target);a=s.val(),t=1,N(),et()}));const K=$(".search-input");let L;$(".search-btn").on("click",(()=>{t=1,et()})),K.on("keyup",(a=>{13==a.keyCode&&(t=1,et())}));const P=$(".date-btn"),Q=$("#brew-date-start"),R=$("#brew-date-end");let U,V;P.on("click",(()=>{if(R.val()){let t=R.val().substr(0,4),a=R.val().substr(5,2);U=`${a}-${t}`}if(Q.val()){let t=Q.val().substr(0,4),a=Q.val().substr(5,2);V=`${a}-${t}`}t=1,et()}));const W=$("#abv-low"),X=$("#abv-high");let tt,at;$("#slider-range").slider({range:!0,min:0,max:100,step:.1,values:[0,100],slide:function(t,a){$(W).val(a.values[0]),$(X).val(a.values[1])}}),$(W).val($("#slider-range").slider("values",0)),$(X).val($("#slider-range").slider("values",1));$(".abv-btn").on("click",(()=>{t=1,et()}));$(".food-btn").on("click",(()=>{t=1,et()})),e.on("click",".no-beers-btn",(()=>{o=i,K.val(""),Q.val(null),R.val(null),r()}));const et=()=>{o=`https://api.punkapi.com/v2/beers?page=${t}&per_page=${a}`,L=K.val();const e=$("input[name=food]:checked").val();if(L){let t=L.replace(" ","_");o=`${o}&beer_name=${t}`}V&&(o=`${o}&brewed_after=${V}`),U&&(o=`${o}&brewed_before=${U}`),tt=$("#abv-low").val(),at=$("#abv-high").val(),0!=at&&(o=`${o}&abv_lt=${at}`),100!=tt&&(o=`${o}&abv_gt=${tt}`),e&&(o=`${o}&food=${e}`),(()=>{const t=$(".products").position().top-50;$(window).scrollTop(t)})(),r()};$(window).on("click",(t=>{$(t.target).hasClass("modal-overlay")&&(G(),b())})),$(window).on("keyup",(t=>{27==t.keyCode&&(G(),b())}))}));